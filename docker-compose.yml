version: '3.4'

services:
  building1:
    image: volttron/volttron:tcc
    container_name: building1
    hostname: building1
    networks:
      tcc_network:
        ipv4_address: 172.28.5.1
    ports:
      # host_port:container_port
      # port for VIP-address
      - 22911:22916
      # ssl port for web
      - 8441:8443
    environment:
      - CONFIG=/home/volttron/configs
      - LOCAL_USER_ID=1000
    volumes:
      - ./platform_configs/building1/agent_configs:/home/volttron/configs
      - ./platform_configs/building1/building1_config.yml:/platform_config.yml

#    volumes:
      #change the following to map to the respective configs
#       - ./transactivecontrol/MarketAgents/:/home/volttron/volttron/config/
#       - ./log/:/code/volttron/volttron/log
#       - ./volttron-GS/:/home/volttron/volttron/transactivecontrol
#       - ./source/bcvtb:/home/volttron/volttron/bcvtb
#    command: bash upgrade-scripts/upgrade-b1-tns

  smalloffice:
    image: volttron/volttron:tcc
    container_name: smalloffice
    hostname: smalloffice
    networks:
      tcc_network:
        ipv4_address: 172.28.5.2
    ports:
      # host_port:container_port
      # port for VIP-address
      - 22912:22916
      # ssl port for web
      - 8442:8443
    environment:
      - CONFIG=/home/volttron/configs
      - LOCAL_USER_ID=1000
    volumes:
      - ./platform_configs/smalloffice/agent_configs:/home/volttron/configs
      - ./platform_configs/smalloffice/smalloffice_config.yml:/platform_config.yml

#    command: bash upgrade-scripts/upgrade-sm-tns

  largeoffice:
    image: volttron/volttron:tcc
    container_name: largeoffice
    hostname: largeoffice
    networks:
      tcc_network:
        ipv4_address: 172.28.5.3
    ports:
      # host_port:container_port
      # port for VIP-address
      - 22913:22916
      # ssl port for web
      - 8443:8443
    environment:
      - CONFIG=/home/volttron/configs
      - LOCAL_USER_ID=1000
    volumes:
      - ./platform_configs/largeoffice/agent_configs:/home/volttron/configs
      - ./platform_configs/largeoffice/largeoffice_config.yml:/platform_config.yml
      - volttron_largeoffice:/code/volttron
      - log_largeoffice:/home/volttron/volttron/log
#    command: bash upgrade-scripts/upgrade-lo-tns

  brsw:
    image: volttron/volttron:tcc
    container_name: brsw
    hostname: brsw
    networks:
      tcc_network:
        ipv4_address: 172.28.5.4
    ports:
      # host_port:container_port
      # port for VIP-address
      - 22914:22916
      # ssl port for web
      - 8444:8443
    environment:
      - CONFIG=/home/volttron/configs
      - LOCAL_USER_ID=1000
    volumes:
      - ./platform_configs/brsw/agent_configs:/home/volttron/configs
      - ./platform_configs/brsw/brsw_config.yml:/platform_config.yml
      - volttron_brsw:/code/volttron
      - log_brsw:/home/volttron/volttron/log

  central:
    image: volttron/volttron:tcc
    container_name: central
    hostname: central
    networks:
      tcc_network:
        ipv4_address: 172.28.5.5
    ports:
      # host_port:container_port
      # port for VIP-address
      - 22915:22916
      # ssl port for web
      - 8445:8443
    environment:
      - CONFIG=/home/volttron/configs
      - LOCAL_USER_ID=1000
    volumes:
      - ./platform_configs/central/agent_configs:/home/volttron/configs
      - ./platform_configs/central/central_platform_config.yml:/platform_config.yml


networks:
  tcc_network:
    name: tcc_network
    driver: bridge
    ipam:
     config:
       - subnet: 172.28.0.0/16
         ip_range: 172.28.5.0/24

volumes:
  volttron_largeoffice:
    name: tcc_volttron_largeoffice
  log_largeoffice:
    name: tcc_log_largeoffice
  volttron_brsw:
    name: tcc_volttron_brsw
  log_brsw:
    name: tcc_log_brsw